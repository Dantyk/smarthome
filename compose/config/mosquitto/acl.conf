# SmartHome MQTT ACL (Access Control List)
#
# Format: topic [read|write|readwrite] <topic>
#
# Pattern matching:
# # - matches multiple levels (e.g., cmd/# matches cmd/room/light)
# + - matches single level (e.g., cmd/+/light matches cmd/room/light but not cmd/room/bedroom/light)

# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# Admin User - Full Access
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

user admin
topic readwrite #

# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# Node-RED - System Control
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

user nodered

# Commands - can publish to all cmd topics
topic write cmd/#

# Status - can read all status updates
topic read stat/#

# Virtual sensors - full access
topic readwrite virt/#

# Events - can publish and subscribe
topic readwrite event/#

# System - full access for internal events
topic readwrite sys/#

# Config - read-only
topic read config/#

# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# UI - Web Interface
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

user ui

# Commands - can publish to cmd topics (user actions)
topic write cmd/#

# Status - read-only (display current state)
topic read stat/#

# Virtual sensors - read-only
topic read virt/#

# Events - read-only (display alerts)
topic read event/#

# Config - read-only
topic read config/#

# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# Zigbee2MQTT - Device Integration
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

user zigbee2mqtt

# Zigbee bridge topics
topic readwrite zigbee2mqtt/#

# Status updates for devices
topic write stat/+/+

# Can read commands to pass through
topic read cmd/#

# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# Z-Wave - Device Integration
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

user zwave

# Z-Wave bridge topics
topic readwrite zwave/#

# Status updates
topic write stat/+/+

# Can read commands
topic read cmd/#

# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# Monitor User - Read-Only (for dashboards, logging)
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

user monitor

# Can read all topics but not write
topic read #

# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# Guest User - Limited Access
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

user guest

# Can only read status and send basic commands
topic read stat/#
topic write cmd/living_room/#
topic read event/#

# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# Safety Pattern - Allow Safety Events from All
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

# All users can publish safety events
pattern readwrite event/safety/#

# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# Anonymous/Test Users - Limited Test Topics
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

# Allow anonymous clients (integration tests) to use test/* topics
pattern readwrite test/#
pattern readwrite cmd/test/#
pattern readwrite stat/#

# Allow anonymous Node-RED (temporary - TODO: add credentials)
pattern readwrite virt/#
pattern readwrite event/#
pattern readwrite cmd/#
pattern readwrite meta/#
